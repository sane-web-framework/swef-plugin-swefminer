<?php

$options            = array (
    ''              => 'SwefMiner options:'
   ,'inspect'       => 'Inspect plugin properties'
);
foreach ($this->tables as $dbn=>$ts) {
    $options[$dbn]  = $dbn;
}
$option             = $this->page->_GET (SWEF_GET_OPTION);
if (!array_key_exists($option,$options)) {
    $option         = SWEF_STR__EMPTY;
}
if (array_key_exists($option,$this->tables)) {
    $dbn            = $option;
    $tables         = $this->tables[$dbn];
}
else {
    $tables         = array ();
}
?>

<div id="swefminer-dash" class="plugin plugin-dash">

  <h2>Dashboard for SwefMiner</h2>

  <form class="options" method="get" action="">
    <input type="hidden" name="<?php echo htmlentities (SWEF_GET_CLASSNAME); ?>" value="\Swef\SwefMiner" />
<?php $this->page->pull ('global.form.select.auto_submit',SWEF_GET_OPTION,$option,'options',$options); ?>
  </form>

<?php if($option=='inspect'): ?>

  <?php $this->_info (); ?>

<?php else: ?>

  <form id="swefminer-form-table" method="post" action="">

    <table class="fill">
<?php   foreach($tables as $table): ?>

      <tbody class="list">
      <tr>
<?php if(array_key_exists(swefminer_col_table,$table)): ?>

        <td>
          <details class="tooltip">
            <summary>Remove</summary>
            <div class="tooltip tooltip-top-left">
              <p>Remove <?php echo htmlentities ($table[swefminer_col_table_name]); ?> from model:</p>
              <p><a href="">Remove</a></p>
            </div>
          </details>
        </td>
        <td>
          <strong><?php echo htmlentities ($table[swefminer_col_table_schema]); ?>.<?php echo htmlentities ($table[swefminer_col_table_name]); ?></strong>
        </td>
        <td>
          <strong><a href=""><?php echo htmlentities ($table[swefminer_col_title]); ?></a></strong>
        </td>
        <td>
          <em><?php echo htmlentities ($table[swefminer_col_description]); ?></em>
        </td>
        <td>
        <details class="tooltip">
          <summary>?</summary>
          <pre class="tooltip tooltip-top-right"><?php echo htmlentities (print_r($table,SWEF_BOOL_TRUE)); ?></pre>
        </details>
        </td>
<?php else: ?>

        <td>
          <details class="tooltip">
            <summary>Add</summary>
            <div class="tooltip tooltip-top-left">
              <p>Add this table to model:</p>
              <p><a href="">Add</a></p>
            </div>
          </details>
        </td>
        <td>
          <?php echo htmlentities ($table[swefminer_col_table_schema]); ?>.<?php echo htmlentities ($table[swefminer_col_table_name]); ?>
        </td>
        <td>
          &nbsp;
        </td>
        <td>
          &nbsp;
        </td>
        <td>
          <details class="tooltip">
            <summary>?</summary>
            <pre class="tooltip tooltip-top-right"><?php echo htmlentities (print_r($table,SWEF_BOOL_TRUE)); ?></pre>
          </details>
        </td>
<?php endif; ?>

      </tr>
<?php   endforeach; ?>

      </tbody>
    </table>

  </form>

<?php endif; ?>

</div>

